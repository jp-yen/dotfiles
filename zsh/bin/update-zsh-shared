#!/bin/bash
set -e

if [ "$EUID" -ne 0 ]; then
    echo "エラー: このスクリプトはroot権限で実行する必要があります"
    echo "sudo $0 を使用してください"
    exit 1
fi

echo "Oh My Zsh本体を更新しています..."
git -C /usr/share/oh-my-zsh pull || echo "  更新に失敗しました"

echo "プラグインとテーマを更新しています..."
find /usr/share/oh-my-zsh/custom -maxdepth 2 -type d -name ".git" | while read gitdir; do
    dir=$(dirname "$gitdir")
    echo "  $(basename "$dir") を更新中..."
    git -C "$dir" pull || echo "    更新に失敗しました"
done

echo "✓ 更新が完了しました"
